const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Q1j0STqS.js","assets/index-rlvoDh60.js","assets/index-CjCS5sN2.css"])))=>i.map(i=>d[i]);
import{dq as X,P as wt,dr as Ye,ds as je,dt as _e,du as bt,dv as Pt,dw as Ct,dx as It,dy as Et,dz as Ot,dA as At,dB as fe,dC as K,dD as $t,dE as Q,dF as Ze,dG as et,dH as $,dI as jt,dJ as _t,dK as ce,dL as He,_ as Ht}from"./index-rlvoDh60.js";var Y={exports:{}},Se;function St(){return Se||(Se=1,function(s,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof X<"u"&&X,i=function(){function o(){this.fetch=!1,this.DOMException=t.DOMException}return o.prototype=t,new o}();(function(o){(function(n){var c=typeof o<"u"&&o||typeof self<"u"&&self||typeof X<"u"&&X||{},p={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function g(a){return a&&DataView.prototype.isPrototypeOf(a)}if(p.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(a){return a&&y.indexOf(Object.prototype.toString.call(a))>-1};function v(a){if(typeof a!="string"&&(a=String(a)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(a)||a==="")throw new TypeError('Invalid character in header field name: "'+a+'"');return a.toLowerCase()}function P(a){return typeof a!="string"&&(a=String(a)),a}function re(a){var h={next:function(){var l=a.shift();return{done:l===void 0,value:l}}};return p.iterable&&(h[Symbol.iterator]=function(){return h}),h}function w(a){this.map={},a instanceof w?a.forEach(function(h,l){this.append(l,h)},this):Array.isArray(a)?a.forEach(function(h){if(h.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+h.length);this.append(h[0],h[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(h){this.append(h,a[h])},this)}w.prototype.append=function(a,h){a=v(a),h=P(h);var l=this.map[a];this.map[a]=l?l+", "+h:h},w.prototype.delete=function(a){delete this.map[v(a)]},w.prototype.get=function(a){return a=v(a),this.has(a)?this.map[a]:null},w.prototype.has=function(a){return this.map.hasOwnProperty(v(a))},w.prototype.set=function(a,h){this.map[v(a)]=P(h)},w.prototype.forEach=function(a,h){for(var l in this.map)this.map.hasOwnProperty(l)&&a.call(h,this.map[l],l,this)},w.prototype.keys=function(){var a=[];return this.forEach(function(h,l){a.push(l)}),re(a)},w.prototype.values=function(){var a=[];return this.forEach(function(h){a.push(h)}),re(a)},w.prototype.entries=function(){var a=[];return this.forEach(function(h,l){a.push([l,h])}),re(a)},p.iterable&&(w.prototype[Symbol.iterator]=w.prototype.entries);function ne(a){if(!a._noBody){if(a.bodyUsed)return Promise.reject(new TypeError("Already read"));a.bodyUsed=!0}}function Ee(a){return new Promise(function(h,l){a.onload=function(){h(a.result)},a.onerror=function(){l(a.error)}})}function lt(a){var h=new FileReader,l=Ee(h);return h.readAsArrayBuffer(a),l}function ut(a){var h=new FileReader,l=Ee(h),f=/charset=([A-Za-z0-9_-]+)/.exec(a.type),m=f?f[1]:"utf-8";return h.readAsText(a,m),l}function dt(a){for(var h=new Uint8Array(a),l=new Array(h.length),f=0;f<h.length;f++)l[f]=String.fromCharCode(h[f]);return l.join("")}function Oe(a){if(a.slice)return a.slice(0);var h=new Uint8Array(a.byteLength);return h.set(new Uint8Array(a)),h.buffer}function Ae(){return this.bodyUsed=!1,this._initBody=function(a){this.bodyUsed=this.bodyUsed,this._bodyInit=a,a?typeof a=="string"?this._bodyText=a:p.blob&&Blob.prototype.isPrototypeOf(a)?this._bodyBlob=a:p.formData&&FormData.prototype.isPrototypeOf(a)?this._bodyFormData=a:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)?this._bodyText=a.toString():p.arrayBuffer&&p.blob&&g(a)?(this._bodyArrayBuffer=Oe(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||_(a))?this._bodyArrayBuffer=Oe(a):this._bodyText=a=Object.prototype.toString.call(a):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof a=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var a=ne(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var a=ne(this);return a||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(p.blob)return this.blob().then(lt);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var a=ne(this);if(a)return a;if(this._bodyBlob)return ut(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(dt(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(vt)}),this.json=function(){return this.text().then(JSON.parse)},this}var ft=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function mt(a){var h=a.toUpperCase();return ft.indexOf(h)>-1?h:a}function H(a,h){if(!(this instanceof H))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');h=h||{};var l=h.body;if(a instanceof H){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,h.headers||(this.headers=new w(a.headers)),this.method=a.method,this.mode=a.mode,this.signal=a.signal,!l&&a._bodyInit!=null&&(l=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);if(this.credentials=h.credentials||this.credentials||"same-origin",(h.headers||!this.headers)&&(this.headers=new w(h.headers)),this.method=mt(h.method||this.method||"GET"),this.mode=h.mode||this.mode||null,this.signal=h.signal||this.signal||function(){if("AbortController"in c){var u=new AbortController;return u.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&l)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(l),(this.method==="GET"||this.method==="HEAD")&&(h.cache==="no-store"||h.cache==="no-cache")){var f=/([?&])_=[^&]*/;if(f.test(this.url))this.url=this.url.replace(f,"$1_="+new Date().getTime());else{var m=/\?/;this.url+=(m.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}H.prototype.clone=function(){return new H(this,{body:this._bodyInit})};function vt(a){var h=new FormData;return a.trim().split("&").forEach(function(l){if(l){var f=l.split("="),m=f.shift().replace(/\+/g," "),u=f.join("=").replace(/\+/g," ");h.append(decodeURIComponent(m),decodeURIComponent(u))}}),h}function gt(a){var h=new w,l=a.replace(/\r?\n[\t ]+/g," ");return l.split("\r").map(function(f){return f.indexOf(`
`)===0?f.substr(1,f.length):f}).forEach(function(f){var m=f.split(":"),u=m.shift().trim();if(u){var W=m.join(":").trim();try{h.append(u,W)}catch(oe){console.warn("Response "+oe.message)}}}),h}Ae.call(H.prototype);function A(a,h){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(h||(h={}),this.type="default",this.status=h.status===void 0?200:h.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=h.statusText===void 0?"":""+h.statusText,this.headers=new w(h.headers),this.url=h.url||"",this._initBody(a)}Ae.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},A.error=function(){var a=new A(null,{status:200,statusText:""});return a.ok=!1,a.status=0,a.type="error",a};var yt=[301,302,303,307,308];A.redirect=function(a,h){if(yt.indexOf(h)===-1)throw new RangeError("Invalid status code");return new A(null,{status:h,headers:{location:a}})},n.DOMException=c.DOMException;try{new n.DOMException}catch{n.DOMException=function(h,l){this.message=h,this.name=l;var f=Error(h);this.stack=f.stack},n.DOMException.prototype=Object.create(Error.prototype),n.DOMException.prototype.constructor=n.DOMException}function ae(a,h){return new Promise(function(l,f){var m=new H(a,h);if(m.signal&&m.signal.aborted)return f(new n.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function W(){u.abort()}u.onload=function(){var b={statusText:u.statusText,headers:gt(u.getAllResponseHeaders()||"")};m.url.indexOf("file://")===0&&(u.status<200||u.status>599)?b.status=200:b.status=u.status,b.url="responseURL"in u?u.responseURL:b.headers.get("X-Request-URL");var S="response"in u?u.response:u.responseText;setTimeout(function(){l(new A(S,b))},0)},u.onerror=function(){setTimeout(function(){f(new TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){f(new TypeError("Network request timed out"))},0)},u.onabort=function(){setTimeout(function(){f(new n.DOMException("Aborted","AbortError"))},0)};function oe(b){try{return b===""&&c.location.href?c.location.href:b}catch{return b}}if(u.open(m.method,oe(m.url),!0),m.credentials==="include"?u.withCredentials=!0:m.credentials==="omit"&&(u.withCredentials=!1),"responseType"in u&&(p.blob?u.responseType="blob":p.arrayBuffer&&(u.responseType="arraybuffer")),h&&typeof h.headers=="object"&&!(h.headers instanceof w||c.Headers&&h.headers instanceof c.Headers)){var $e=[];Object.getOwnPropertyNames(h.headers).forEach(function(b){$e.push(v(b)),u.setRequestHeader(b,P(h.headers[b]))}),m.headers.forEach(function(b,S){$e.indexOf(S)===-1&&u.setRequestHeader(S,b)})}else m.headers.forEach(function(b,S){u.setRequestHeader(S,b)});m.signal&&(m.signal.addEventListener("abort",W),u.onreadystatechange=function(){u.readyState===4&&m.signal.removeEventListener("abort",W)}),u.send(typeof m._bodyInit>"u"?null:m._bodyInit)})}return ae.polyfill=!0,c.fetch||(c.fetch=ae,c.Headers=w,c.Request=H,c.Response=A),n.Headers=w,n.Request=H,n.Response=A,n.fetch=ae,Object.defineProperty(n,"__esModule",{value:!0}),n})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var r=t.fetch?t:i;e=r.fetch,e.default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,s.exports=e}(Y,Y.exports)),Y.exports}var Dt=St();const De=wt(Dt);var qt=Object.defineProperty,Nt=Object.defineProperties,Tt=Object.getOwnPropertyDescriptors,qe=Object.getOwnPropertySymbols,Rt=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,Ne=(s,e,t)=>e in s?qt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Te=(s,e)=>{for(var t in e||(e={}))Rt.call(e,t)&&Ne(s,t,e[t]);if(qe)for(var t of qe(e))Mt.call(e,t)&&Ne(s,t,e[t]);return s},Re=(s,e)=>Nt(s,Tt(e));const Ut={Accept:"application/json","Content-Type":"application/json"},Bt="POST",Me={headers:Ut,method:Bt},Ue=10;class j{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Ye.EventEmitter,this.isAvailable=!1,this.registering=!1,!je(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=_e(e),i=await(await De(this.url,Re(Te({},Me),{body:t}))).json();this.onPayload({data:i})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!je(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,r)=>{this.events.once("register_error",o=>{this.resetMaxListeners(),r(o)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return r(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=_e({id:1,jsonrpc:"2.0",method:"test",params:[]});await De(e,Re(Te({},Me),{body:t}))}this.onOpen()}catch(t){const i=this.parseError(t);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?bt(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),r=i.message||i.toString(),o=Pt(e,r);this.events.emit("payload",o)}parseError(e,t=this.url){return Ct(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ue&&this.events.setMaxListeners(Ue)}}const Be="error",xt="wss://relay.walletconnect.org",Ft="wc",Lt="universal_provider",Z=`${Ft}@2:${Lt}:`,tt="https://rpc.walletconnect.org/v1/",G="generic",kt=`${tt}bundler`,O={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function zt(){}function Pe(s){return s==null||typeof s!="object"&&typeof s!="function"}function Ce(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function Gt(s){if(Pe(s))return s;if(Array.isArray(s)||Ce(s)||s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer)return s.slice(0);const e=Object.getPrototypeOf(s),t=e.constructor;if(s instanceof Date||s instanceof Map||s instanceof Set)return new t(s);if(s instanceof RegExp){const i=new t(s);return i.lastIndex=s.lastIndex,i}if(s instanceof DataView)return new t(s.buffer.slice(0));if(s instanceof Error){const i=new t(s.message);return i.stack=s.stack,i.name=s.name,i.cause=s.cause,i}if(typeof File<"u"&&s instanceof File)return new t([s],s.name,{type:s.type,lastModified:s.lastModified});if(typeof s=="object"){const i=Object.create(e);return Object.assign(i,s)}return s}function xe(s){return typeof s=="object"&&s!==null}function st(s){return Object.getOwnPropertySymbols(s).filter(e=>Object.prototype.propertyIsEnumerable.call(s,e))}function it(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}const Jt="[object RegExp]",rt="[object String]",nt="[object Number]",at="[object Boolean]",ot="[object Arguments]",Vt="[object Symbol]",Qt="[object Date]",Kt="[object Map]",Wt="[object Set]",Xt="[object Array]",Yt="[object ArrayBuffer]",Zt="[object Object]",es="[object DataView]",ts="[object Uint8Array]",ss="[object Uint8ClampedArray]",is="[object Uint16Array]",rs="[object Uint32Array]",ns="[object Int8Array]",as="[object Int16Array]",os="[object Int32Array]",cs="[object Float32Array]",hs="[object Float64Array]";function ps(s,e){return V(s,void 0,s,new Map,e)}function V(s,e,t,i=new Map,r=void 0){const o=r==null?void 0:r(s,e,t,i);if(o!=null)return o;if(Pe(s))return s;if(i.has(s))return i.get(s);if(Array.isArray(s)){const n=new Array(s.length);i.set(s,n);for(let c=0;c<s.length;c++)n[c]=V(s[c],c,t,i,r);return Object.hasOwn(s,"index")&&(n.index=s.index),Object.hasOwn(s,"input")&&(n.input=s.input),n}if(s instanceof Date)return new Date(s.getTime());if(s instanceof RegExp){const n=new RegExp(s.source,s.flags);return n.lastIndex=s.lastIndex,n}if(s instanceof Map){const n=new Map;i.set(s,n);for(const[c,p]of s)n.set(c,V(p,c,t,i,r));return n}if(s instanceof Set){const n=new Set;i.set(s,n);for(const c of s)n.add(V(c,void 0,t,i,r));return n}if(typeof Buffer<"u"&&Buffer.isBuffer(s))return s.subarray();if(Ce(s)){const n=new(Object.getPrototypeOf(s)).constructor(s.length);i.set(s,n);for(let c=0;c<s.length;c++)n[c]=V(s[c],c,t,i,r);return n}if(s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer)return s.slice(0);if(s instanceof DataView){const n=new DataView(s.buffer.slice(0),s.byteOffset,s.byteLength);return i.set(s,n),D(n,s,t,i,r),n}if(typeof File<"u"&&s instanceof File){const n=new File([s],s.name,{type:s.type});return i.set(s,n),D(n,s,t,i,r),n}if(s instanceof Blob){const n=new Blob([s],{type:s.type});return i.set(s,n),D(n,s,t,i,r),n}if(s instanceof Error){const n=new s.constructor;return i.set(s,n),n.message=s.message,n.name=s.name,n.stack=s.stack,n.cause=s.cause,D(n,s,t,i,r),n}if(typeof s=="object"&&ls(s)){const n=Object.create(Object.getPrototypeOf(s));return i.set(s,n),D(n,s,t,i,r),n}return s}function D(s,e,t=s,i,r){const o=[...Object.keys(e),...st(e)];for(let n=0;n<o.length;n++){const c=o[n],p=Object.getOwnPropertyDescriptor(s,c);(p==null||p.writable)&&(s[c]=V(e[c],c,t,i,r))}}function ls(s){switch(it(s)){case ot:case Xt:case Yt:case es:case at:case Qt:case cs:case hs:case ns:case as:case os:case Kt:case nt:case Zt:case Jt:case Wt:case rt:case Vt:case ts:case ss:case is:case rs:return!0;default:return!1}}function us(s,e){return ps(s,(t,i,r,o)=>{if(typeof s=="object")switch(Object.prototype.toString.call(s)){case nt:case rt:case at:{const n=new s.constructor(s==null?void 0:s.valueOf());return D(n,s),n}case ot:{const n={};return D(n,s),n.length=s.length,n[Symbol.iterator]=s[Symbol.iterator],n}default:return}})}function Fe(s){return us(s)}function Le(s){return s!==null&&typeof s=="object"&&it(s)==="[object Arguments]"}function ds(s){return Ce(s)}function fs(s){var t;if(typeof s!="object"||s==null)return!1;if(Object.getPrototypeOf(s)===null)return!0;if(Object.prototype.toString.call(s)!=="[object Object]"){const i=s[Symbol.toStringTag];return i==null||!((t=Object.getOwnPropertyDescriptor(s,Symbol.toStringTag))!=null&&t.writable)?!1:s.toString()===`[object ${i}]`}let e=s;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(s)===e}function ms(s,...e){const t=e.slice(0,-1),i=e[e.length-1];let r=s;for(let o=0;o<t.length;o++){const n=t[o];r=me(r,n,i,new Map)}return r}function me(s,e,t,i){if(Pe(s)&&(s=Object(s)),e==null||typeof e!="object")return s;if(i.has(e))return Gt(i.get(e));if(i.set(e,s),Array.isArray(e)){e=e.slice();for(let o=0;o<e.length;o++)e[o]=e[o]??void 0}const r=[...Object.keys(e),...st(e)];for(let o=0;o<r.length;o++){const n=r[o];let c=e[n],p=s[n];if(Le(c)&&(c={...c}),Le(p)&&(p={...p}),typeof Buffer<"u"&&Buffer.isBuffer(c)&&(c=Fe(c)),Array.isArray(c))if(typeof p=="object"&&p!=null){const y=[],_=Reflect.ownKeys(p);for(let v=0;v<_.length;v++){const P=_[v];y[P]=p[P]}p=y}else p=[];const g=t(p,c,n,s,e,i);g!=null?s[n]=g:Array.isArray(c)||xe(p)&&xe(c)?s[n]=me(p,c,t,i):p==null&&fs(c)?s[n]=me({},c,t,i):p==null&&ds(c)?s[n]=Fe(c):(p===void 0||c!==void 0)&&(s[n]=c)}return s}function vs(s,...e){return ms(s,...e,zt)}var gs=Object.defineProperty,ys=Object.defineProperties,ws=Object.getOwnPropertyDescriptors,ke=Object.getOwnPropertySymbols,bs=Object.prototype.hasOwnProperty,Ps=Object.prototype.propertyIsEnumerable,ze=(s,e,t)=>e in s?gs(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ee=(s,e)=>{for(var t in e||(e={}))bs.call(e,t)&&ze(s,t,e[t]);if(ke)for(var t of ke(e))Ps.call(e,t)&&ze(s,t,e[t]);return s},Cs=(s,e)=>ys(s,ws(e));function I(s,e,t){var i;const r=et(s);return((i=e.rpcMap)==null?void 0:i[r.reference])||`${tt}?chainId=${r.namespace}:${r.reference}&projectId=${t}`}function q(s){return s.includes(":")?s.split(":")[1]:s}function ct(s){return s.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function Is(s,e){const t=Object.keys(e.namespaces).filter(r=>r.includes(s));if(!t.length)return[];const i=[];return t.forEach(r=>{const o=e.namespaces[r].accounts;i.push(...o)}),i}function he(s={},e={}){const t=Ge(s),i=Ge(e);return vs(t,i)}function Ge(s){var e,t,i,r;const o={};if(!_t(s))return o;for(const[n,c]of Object.entries(s)){const p=Ze(n)?[n]:c.chains,g=c.methods||[],y=c.events||[],_=c.rpcMap||{},v=Q(n);o[v]=Cs(ee(ee({},o[v]),c),{chains:ce(p,(e=o[v])==null?void 0:e.chains),methods:ce(g,(t=o[v])==null?void 0:t.methods),events:ce(y,(i=o[v])==null?void 0:i.events),rpcMap:ee(ee({},_),(r=o[v])==null?void 0:r.rpcMap)})}return o}function Es(s){return s.includes(":")?s.split(":")[2]:s}function Je(s){const e={};for(const[t,i]of Object.entries(s)){const r=i.methods||[],o=i.events||[],n=i.accounts||[],c=Ze(t)?[t]:i.chains?i.chains:ct(i.accounts);e[t]={chains:c,methods:r,events:o,accounts:n}}return e}function pe(s){return typeof s=="number"?s:s.includes("0x")?parseInt(s,16):(s=s.includes(":")?s.split(":")[1]:s,isNaN(Number(s))?s:Number(s))}const ht={},d=s=>ht[s],le=(s,e)=>{ht[s]=e};var Os=Object.defineProperty,As=(s,e,t)=>e in s?Os(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,N=(s,e,t)=>As(s,typeof e!="symbol"?e+"":e,t);class $s{constructor(e){N(this,"name","polkadot"),N(this,"client"),N(this,"httpProviders"),N(this,"events"),N(this,"namespace"),N(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const r=q(t);e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}}var js=Object.defineProperty,_s=Object.defineProperties,Hs=Object.getOwnPropertyDescriptors,Ve=Object.getOwnPropertySymbols,Ss=Object.prototype.hasOwnProperty,Ds=Object.prototype.propertyIsEnumerable,ve=(s,e,t)=>e in s?js(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Qe=(s,e)=>{for(var t in e||(e={}))Ss.call(e,t)&&ve(s,t,e[t]);if(Ve)for(var t of Ve(e))Ds.call(e,t)&&ve(s,t,e[t]);return s},Ke=(s,e)=>_s(s,Hs(e)),T=(s,e,t)=>ve(s,typeof e!="symbol"?e+"":e,t);class qs{constructor(e){T(this,"name","eip155"),T(this,"client"),T(this,"chainId"),T(this,"namespace"),T(this,"httpProviders"),T(this,"events"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const i=t||I(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const r=parseInt(q(t));e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,i;let r=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";r=r.startsWith("0x")?r:`0x${r}`;const o=parseInt(r,16);if(this.isChainApproved(o))this.setDefaultChain(`${o}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:r}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${o}`);else throw new Error(`Failed to switch to chain 'eip155:${o}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,i,r;const o=(i=(t=e.request)==null?void 0:t.params)==null?void 0:i[0];if(!o)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const n=this.client.session.get(e.topic),c=((r=n==null?void 0:n.sessionProperties)==null?void 0:r.capabilities)||{};if(c!=null&&c[o])return c==null?void 0:c[o];const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Ke(Qe({},n.sessionProperties||{}),{capabilities:Ke(Qe({},c||{}),{[o]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var t,i;const r=this.client.session.get(e.topic),o=(t=r.sessionProperties)==null?void 0:t.bundler_name;if(o){const c=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(c,e)}catch(p){console.warn("Failed to fetch call status from bundler",p,c)}}const n=(i=r.sessionProperties)==null?void 0:i.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(c){console.warn("Failed to fetch call status from custom bundler",c,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var i;const r=new URL(e),o=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(jt("eth_getUserOperationReceipt",[(i=t.request.params)==null?void 0:i[0]]))});if(!o.ok)throw new Error(`Failed to fetch user operation receipt - ${o.status}`);return await o.json()}getBundlerUrl(e,t){return`${kt}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var Ns=Object.defineProperty,Ts=(s,e,t)=>e in s?Ns(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,R=(s,e,t)=>Ts(s,typeof e!="symbol"?e+"":e,t);class Rs{constructor(e){R(this,"name","solana"),R(this,"client"),R(this,"httpProviders"),R(this,"events"),R(this,"namespace"),R(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const r=q(t);e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}}var Ms=Object.defineProperty,Us=(s,e,t)=>e in s?Ms(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,M=(s,e,t)=>Us(s,typeof e!="symbol"?e+"":e,t);class Bs{constructor(e){M(this,"name","cosmos"),M(this,"client"),M(this,"httpProviders"),M(this,"events"),M(this,"namespace"),M(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const r=q(t);e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}}var xs=Object.defineProperty,Fs=(s,e,t)=>e in s?xs(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,U=(s,e,t)=>Fs(s,typeof e!="symbol"?e+"":e,t);class Ls{constructor(e){U(this,"name","algorand"),U(this,"client"),U(this,"httpProviders"),U(this,"events"),U(this,"namespace"),U(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const i=t||I(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new $(new j(i,d("disableProviderPing")))}}var ks=Object.defineProperty,zs=(s,e,t)=>e in s?ks(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,B=(s,e,t)=>zs(s,typeof e!="symbol"?e+"":e,t);class Gs{constructor(e){B(this,"name","cip34"),B(this,"client"),B(this,"httpProviders"),B(this,"events"),B(this,"namespace"),B(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const i=this.getCardanoRPCUrl(t),r=q(t);e[r]=this.createHttpProvider(r,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}}var Js=Object.defineProperty,Vs=(s,e,t)=>e in s?Js(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,x=(s,e,t)=>Vs(s,typeof e!="symbol"?e+"":e,t);class Qs{constructor(e){x(this,"name","elrond"),x(this,"client"),x(this,"httpProviders"),x(this,"events"),x(this,"namespace"),x(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const r=q(t);e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}}var Ks=Object.defineProperty,Ws=(s,e,t)=>e in s?Ks(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,F=(s,e,t)=>Ws(s,typeof e!="symbol"?e+"":e,t);class Xs{constructor(e){F(this,"name","multiversx"),F(this,"client"),F(this,"httpProviders"),F(this,"events"),F(this,"namespace"),F(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const r=q(t);e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}}var Ys=Object.defineProperty,Zs=(s,e,t)=>e in s?Ys(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,L=(s,e,t)=>Zs(s,typeof e!="symbol"?e+"":e,t);class ei{constructor(e){L(this,"name","near"),L(this,"client"),L(this,"httpProviders"),L(this,"events"),L(this,"namespace"),L(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||I(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace);return typeof i>"u"?void 0:new $(new j(i,d("disableProviderPing")))}}var ti=Object.defineProperty,si=(s,e,t)=>e in s?ti(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,k=(s,e,t)=>si(s,typeof e!="symbol"?e+"":e,t);class ii{constructor(e){k(this,"name","tezos"),k(this,"client"),k(this,"httpProviders"),k(this,"events"),k(this,"namespace"),k(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||I(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace);return typeof i>"u"?void 0:new $(new j(i))}}var ri=Object.defineProperty,ni=(s,e,t)=>e in s?ri(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,z=(s,e,t)=>ni(s,typeof e!="symbol"?e+"":e,t);class ai{constructor(e){z(this,"name",G),z(this,"client"),z(this,"httpProviders"),z(this,"events"),z(this,"namespace"),z(this,"chainId"),this.namespace=e.namespace,this.events=d("events"),this.client=d("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(O.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const i={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(r=>{const o=et(r);i[`${o.namespace}:${o.reference}`]=this.createHttpProvider(r)}),i}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||I(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new $(new j(i,d("disableProviderPing")))}}var oi=Object.defineProperty,ci=Object.defineProperties,hi=Object.getOwnPropertyDescriptors,We=Object.getOwnPropertySymbols,pi=Object.prototype.hasOwnProperty,li=Object.prototype.propertyIsEnumerable,ge=(s,e,t)=>e in s?oi(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,te=(s,e)=>{for(var t in e||(e={}))pi.call(e,t)&&ge(s,t,e[t]);if(We)for(var t of We(e))li.call(e,t)&&ge(s,t,e[t]);return s},ue=(s,e)=>ci(s,hi(e)),E=(s,e,t)=>ge(s,typeof e!="symbol"?e+"":e,t);let ui=class pt{constructor(e){E(this,"client"),E(this,"namespaces"),E(this,"optionalNamespaces"),E(this,"sessionProperties"),E(this,"scopedProperties"),E(this,"events",new It),E(this,"rpcProviders",{}),E(this,"session"),E(this,"providerOpts"),E(this,"logger"),E(this,"uri"),E(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Et(Ot({level:(e==null?void 0:e.logger)||Be})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new pt(e);return await t.initialize(),t}async request(e,t,i){const[r,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(r).request({request:te({},e),chainId:`${r}:${o}`,topic:this.session.topic,expiry:i})}sendAsync(e,t,i,r){const o=new Date().getTime();this.request(e,i,r).then(n=>t(null,At(o,n))).catch(n=>t(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:fe("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:i,response:r}=await this.client.authenticate(e,t);i&&(this.uri=i,this.events.emit("display_uri",i));const o=await r();if(this.session=o.session,this.session){const n=Je(this.session.namespaces);this.namespaces=he(this.namespaces,n),await this.persist("namespaces",this.namespaces),this.onConnect()}return o}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const r=await i();this.session=r;const o=Je(r.namespaces);return this.namespaces=he(this.namespaces,o),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[i,r]=this.validateChain(e),o=this.getProvider(i);o.name===G?o.setDefaultChain(`${i}:${r}`,t):o.setDefaultChain(r,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(K(t)){for(const i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await $t.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Be,relayUrl:this.providerOpts.relayUrl||xt,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(i){throw this.logger.error("Failed to get session",i),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const i=this.client.session.getAll();this.session=i[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Q(t)))];le("client",this.client),le("events",this.events),le("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const i=Is(t,this.session),r=ct(i),o=he(this.namespaces,this.optionalNamespaces),n=ue(te({},o[t]),{accounts:i,chains:r});switch(t){case"eip155":this.rpcProviders[t]=new qs({namespace:n});break;case"algorand":this.rpcProviders[t]=new Ls({namespace:n});break;case"solana":this.rpcProviders[t]=new Rs({namespace:n});break;case"cosmos":this.rpcProviders[t]=new Bs({namespace:n});break;case"polkadot":this.rpcProviders[t]=new $s({namespace:n});break;case"cip34":this.rpcProviders[t]=new Gs({namespace:n});break;case"elrond":this.rpcProviders[t]=new Qs({namespace:n});break;case"multiversx":this.rpcProviders[t]=new Xs({namespace:n});break;case"near":this.rpcProviders[t]=new ei({namespace:n});break;case"tezos":this.rpcProviders[t]=new ii({namespace:n});break;default:this.rpcProviders[G]?this.rpcProviders[G].updateNamespace(n):this.rpcProviders[G]=new ai({namespace:n})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:i}=e;i===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:i,topic:r}=e;if(r!==((t=this.session)==null?void 0:t.topic))return;const{event:o}=i;if(o.name==="accountsChanged"){const n=o.data;n&&K(n)&&this.events.emit("accountsChanged",n.map(Es))}else if(o.name==="chainChanged"){const n=i.chainId,c=i.event.data,p=Q(n),g=pe(n)!==pe(c)?`${p}:${pe(c)}`:n;this.onChainChanged(g)}else this.events.emit(o.name,o.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i,r;if(e!==((i=this.session)==null?void 0:i.topic))return;const{namespaces:o}=t,n=(r=this.client)==null?void 0:r.session.get(e);this.session=ue(te({},n),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",ue(te({},fe("USER_DISCONNECTED")),{data:e.topic})))}),this.on(O.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[G]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:i,sessionProperties:r,scopedProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=r,this.scopedProperties=o}validateChain(e){const[t,i]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,i];if(t&&!Object.keys(this.namespaces||{}).map(n=>Q(n)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];const r=Q(Object.keys(this.namespaces)[0]),o=this.rpcProviders[r].getDefaultChain();return[r,o]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[i,r]=this.validateChain(e);r&&(t||this.getProvider(i).setDefaultChain(r),this.namespaces[i]?this.namespaces[i].defaultChain=r:this.namespaces[`${i}:${r}`]?this.namespaces[`${i}:${r}`].defaultChain=r:this.namespaces[`${i}:${r}`]={defaultChain:r},this.events.emit("chainChanged",r),await this.persist("namespaces",this.namespaces))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var i;const r=((i=this.session)==null?void 0:i.topic)||"";await this.client.core.storage.setItem(`${Z}/${e}${r}`,t)}async getFromStore(e){var t;const i=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Z}/${e}${i}`)}async deleteFromStore(e){var t;const i=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Z}/${e}${i}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const i of t)i.startsWith(Z)&&await this.client.core.storage.removeItem(i)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}};const di=ui,fi="wc",mi="ethereum_provider",vi=`${fi}@2:${mi}:`,gi="https://rpc.walletconnect.org/v1/",ye=["eth_sendTransaction","personal_sign"],yi=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],we=["chainChanged","accountsChanged"],wi=["chainChanged","accountsChanged","message","disconnect","connect"];var bi=Object.defineProperty,Pi=Object.defineProperties,Ci=Object.getOwnPropertyDescriptors,Xe=Object.getOwnPropertySymbols,Ii=Object.prototype.hasOwnProperty,Ei=Object.prototype.propertyIsEnumerable,be=(s,e,t)=>e in s?bi(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,J=(s,e)=>{for(var t in e||(e={}))Ii.call(e,t)&&be(s,t,e[t]);if(Xe)for(var t of Xe(e))Ei.call(e,t)&&be(s,t,e[t]);return s},de=(s,e)=>Pi(s,Ci(e)),C=(s,e,t)=>be(s,typeof e!="symbol"?e+"":e,t);function ie(s){return Number(s[0].split(":")[1])}function se(s){return`0x${s.toString(16)}`}function Oi(s){const{chains:e,optionalChains:t,methods:i,optionalMethods:r,events:o,optionalEvents:n,rpcMap:c}=s;if(!K(e))throw new Error("Invalid chains");const p={chains:e,methods:i||ye,events:o||we,rpcMap:J({},e.length?{[ie(e)]:c[ie(e)]}:{})},g=o==null?void 0:o.filter(P=>!we.includes(P)),y=i==null?void 0:i.filter(P=>!ye.includes(P));if(!t&&!n&&!r&&!(g!=null&&g.length)&&!(y!=null&&y.length))return{required:e.length?p:void 0};const _=(g==null?void 0:g.length)&&(y==null?void 0:y.length)||!t,v={chains:[...new Set(_?p.chains.concat(t||[]):t)],methods:[...new Set(p.methods.concat(r!=null&&r.length?r:yi))],events:[...new Set(p.events.concat(n!=null&&n.length?n:wi))],rpcMap:c};return{required:e.length?p:void 0,optional:t.length?v:void 0}}class Ie{constructor(){C(this,"events",new Ye.EventEmitter),C(this,"namespace","eip155"),C(this,"accounts",[]),C(this,"signer"),C(this,"chainId",1),C(this,"modal"),C(this,"rpc"),C(this,"STORAGE_KEY",vi),C(this,"on",(e,t)=>(this.events.on(e,t),this)),C(this,"once",(e,t)=>(this.events.once(e,t),this)),C(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),C(this,"off",(e,t)=>(this.events.off(e,t),this)),C(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){const t=new Ie;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,i){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),i)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:i}=Oi(this.rpc);try{const r=await new Promise(async(n,c)=>{var p;this.rpc.showQrModal&&((p=this.modal)==null||p.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))}));const g=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(de(J({namespaces:J({},t&&{[this.namespace]:t})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e==null?void 0:e.pairingTopic,scopedProperties:g})).then(y=>{n(y)}).catch(y=>{c(new Error(y.message))})});if(!r)return;const o=He(r.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:se(this.chainId)})}catch(r){throw this.signer.logger.error(r),r}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const i=await new Promise(async(o,n)=>{var c;this.rpc.showQrModal&&((c=this.modal)==null||c.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),n(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(de(J({},e),{chains:this.rpc.chains}),t).then(p=>{o(p)}).catch(p=>{n(new Error(p.message))})}),r=i.session;if(r){const o=He(r.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:se(this.chainId)})}return i}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",se(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",de(J({},fe("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,i;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(i=this.modal)==null||i.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",se(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,i,r]=e.split(":");return{chainId:`${t}:${i}`,address:r}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,i;const r=(t=e==null?void 0:e.chains)!=null?t:[],o=(i=e==null?void 0:e.optionalChains)!=null?i:[],n=r.concat(o);if(!n.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const c=r.length?(e==null?void 0:e.methods)||ye:[],p=r.length?(e==null?void 0:e.events)||we:[],g=(e==null?void 0:e.optionalMethods)||[],y=(e==null?void 0:e.optionalEvents)||[],_=(e==null?void 0:e.rpcMap)||this.buildRpcMap(n,e.projectId),v=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:r==null?void 0:r.map(P=>this.formatChainId(P)),optionalChains:o.map(P=>this.formatChainId(P)),methods:c,events:p,optionalMethods:g,optionalEvents:y,rpcMap:_,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:v,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const i={};return e.forEach(r=>{i[r]=this.getRpcUrl(r,t)}),i}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ie(this.rpc.chains):ie(this.rpc.optionalChains),this.signer=await di.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:i}=await Ht(()=>import("./index-Q1j0STqS.js").then(r=>r.i),__vite__mapDeps([0,1,2]));t=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(J({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:i,rpcMap:r}=e;t&&K(t)&&(this.rpc.chains=t.map(o=>this.formatChainId(o)),t.forEach(o=>{this.rpc.rpcMap[o]=(r==null?void 0:r[o])||this.getRpcUrl(o)})),i&&K(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(o=>this.formatChainId(o)),i.forEach(o=>{this.rpc.rpcMap[o]=(r==null?void 0:r[o])||this.getRpcUrl(o)}))}getRpcUrl(e,t){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${gi}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const $i=Ie;export{$i as EthereumProvider,wi as OPTIONAL_EVENTS,yi as OPTIONAL_METHODS,we as REQUIRED_EVENTS,ye as REQUIRED_METHODS,Ie as default};
